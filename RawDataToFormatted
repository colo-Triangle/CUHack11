import openai
import json


#Turns raw data into more formatted data


# Your OpenAI API key
openai.api_key = "your-api-key-here"
DataFileName = "rawData.json"

# Function to send data to OpenAI for reformatting
def reformat_medical_data(raw_data):
    prompt = f"Reformat the following raw medical data into structured JSON format:\n{json.dumps(raw_data)}"

    response = openai.ChatCompletion.create(
        model="gpt-4",  # Using GPT-4 for better understanding
        messages=[
            {"role": "system", "content": "You are a medical data parser."},
            {"role": "user", "content": prompt}
        ]
    )
    
    return response['choices'][0]['message']['content']

# Get raw medical data from JSON file
file_path_in = DataFileName
with open(file_path_in, "r") as file:
    raw_data = json.load(file)

# Reformat the medical data
structured_data = reformat_medical_data(raw_data)

file_path_out = "formattedData.json"

# Open the file in write mode ('w')
with open(file_path_in, "w") as file:
    # Use json.dump() to write the Python object to the file
    json.dump(structured_data, file, indent=4)

# File is automatically closed after the 'with' block ends
print(f"Data saved to {file_path_out}")